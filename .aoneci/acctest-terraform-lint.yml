name: Golangci-Lint
triggers:
  merge_request:
    paths:
      - '.aoneci/acctest-terraform-lint.yml'
      - 'alicloud/*.go'
jobs:
  #  golangci-lint-review-log:
  #    name: golangci-lint-with-review-log
  #    runs-on: ubuntu-latest
  #    steps:
  #      - name: Check out code into the Go module directory
  #        uses: actions/checkout@v2
  #      - name: golangci-lint
  #        uses: reviewdog/action-golangci-lint@v2
  #        with:
  #          go_version: '1.19.3'
  #          golangci_lint_flags: '--timeout=25m --disable-all -E gofmt ./alicloud'
  #          level: info
  #          reporter: github-pr-check


  megalinter:
    name: MegaLinter
    steps:
      - name: Check out code into the Go module directory
        uses: checkout
      - name: errcheck
        uses: megalinter
        envs:
          ADDITIONAL_EXCLUDED_DIRECTORIES: ['scripts']
          DISABLE_LINTERS: 'GO_REVIVE'
          VALIDATE_ALL_CODEBASE: 'false'
          GO_GOLANGCI_LINT_CLI_LINT_MODE: 'project'
          GO_FILTER_REGEX_EXCLUDE: '.scripts/*'
        inputs:
          language: GO
          compare-to: '${{git.merge_request.targetBranch ?: master}}'